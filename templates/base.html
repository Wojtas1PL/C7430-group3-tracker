<!doctype html>
<html lang="en">
<head>
<title>Flask Leaflet Website</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="{{ url_for('static', filename='map.css') }}" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
crossorigin=""></script>
</head>
<body>
<div id="map"></div>
<script src="{{ url_for('static', filename='map.js') }}"></script>
<script>
{% for marker in markers %}
var marker = L.marker([{{ marker['lat'] }}, {{ marker['lon'] }}]).addTo(map)
    .bindPopup("{{ marker['popup'] }}")
    .openPopup();

// Function to drift the marker
function driftMarker(marker) {
    var driftInterval = setInterval(function() {
        var latLng = marker.getLatLng();
        var newLatLng = L.latLng(
            latLng.lat + (Math.random() - 0.5) * 5, // Adjust the drift intensity as needed
            latLng.lng + (Math.random() - 0.5) * 5  // Adjust the drift intensity as needed
        );
        marker.setLatLng(newLatLng);
    }, 100); // Adjust the drift speed as needed (milliseconds)

    // Stop drifting after a certain time (e.g., 30 seconds)
    setTimeout(function() {
        clearInterval(driftInterval);
    }, 30000); // Adjust the duration of the drift as needed (milliseconds)
}

driftMarker(marker);

{% endfor %}

</script>

<!---<script src="{{ url_for('static', filename='marker.js') }}"></script>-->
</body>
</html>